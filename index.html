<!DOCTYPE html>
<html>
<head>
    <title>Space Builder: Arrow Control</title>
    <script src="https://aframe.io/releases/1.4.0/aframe.min.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <style>
        body { font-family: 'Courier New', monospace; margin: 0; overflow: hidden; background: black; color: lime; }
        
        /* BUILDER INTERFACE */
        #build-screen { display: flex; flex-direction: column; height: 100vh; background: #0a0a1a; }
        #blueprint-area { flex-grow: 1; position: relative; background-image: radial-gradient(#333 1px, transparent 1px); background-size: 20px 20px; border-bottom: 2px solid lime; }
        #parts-menu { height: 45%; overflow-y: scroll; display: grid; grid-template-columns: 1fr 1fr; gap: 8px; padding: 10px; background: #16213e; }
        .part-btn { background: #0f3460; color: white; border: 1px solid lime; padding: 12px; font-size: 11px; text-align: center; cursor: pointer; }
        .del-btn { background: #600; border-color: red; color: white; grid-column: span 2; font-weight: bold; }
        .placed-part { width: 60px; position: absolute; left: 50%; transform: translateX(-50%); border: 1px solid white; color: black; font-weight: bold; font-size: 9px; text-align: center; display: flex; align-items: center; justify-content: center; }

        /* FLIGHT HUD */
        #mobile-hud { display: none; position: absolute; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 10; }
        .hud-panel { position: absolute; background: rgba(0,0,0,0.8); padding: 10px; border: 1px solid lime; pointer-events: auto; }
        #crew-status { top: 10px; left: 10px; width: 160px; }
        .o2-bg { width: 100%; height: 6px; background: #222; border: 1px solid #555; margin-top: 2px; }
        .o2-fill { height: 100%; background: #00f2ff; width: 100%; }
        
        /* ARROW KEY CONTROLS */
        #dpad { position: absolute; bottom: 20px; left: 20px; display: grid; grid-template-columns: 60px 60px 60px; gap: 5px; pointer-events: auto; }
        #thrust-zone { position: absolute; bottom: 20px; right: 20px; pointer-events: auto; }
        .ctrl-btn { width: 60px; height: 60px; background: rgba(0,255,0,0.2); border: 2px solid lime; color: lime; font-weight: bold; border-radius: 10px; }
        .thrust-btn { width: 80px; height: 80px; border-radius: 50%; background: rgba(255,0,0,0.3); border: 2px solid red; color: white; }
    </style>
</head>
<body>

    <div id="build-screen">
        <div id="blueprint-area">
            <div style="padding: 15px;">
                <h3 style="margin:0; color:lime;">ROCKET BUILDER</h3>
                <p style="font-size:12px;">CASH: $<span id="money-display">1000</span> | MASS: <span id="mass-display">0</span>t</p>
                <button onclick="launch()" style="background:red; color:white; border:none; padding:12px; width:100%; font-weight:bold; cursor:pointer;">LAUNCH MISSION</button>
            </div>
        </div>
        <div id="parts-menu">
            <button class="part-btn" onclick="addPart('capsule')">CAPSULE ($200)</button>
            <button class="part-btn" onclick="addPart('booster')">BOOSTER ($400)</button>
            <button class="part-btn" onclick="addPart('fuel_tank')">FUEL TANK ($300)</button>
            <button class="part-btn" onclick="addPart('oxygen')">O2 TANK ($150)</button>
            <button class="part-btn" onclick="addPart('rcs')">RCS ($100)</button>
            <button class="part-btn del-btn" onclick="deleteLastPart()">DELETE LAST PART</button>
        </div>
    </div>

    <div id="mobile-hud">
        <div id="crew-status" class="hud-panel">
            <div style="font-size:11px; color:orange; margin-bottom:5px;">FUEL: <span id="fuel-display">0</span>L</div>
            <div style="font-size:10px;">ASTRO 1 <div class="o2-bg"><div id="o2-1" class="o2-fill"></div></div></div>
            <div style="font-size:10px;">ASTRO 2 <div class="o2-bg"><div id="o2-2" class="o2-fill"></div></div></div>
            <div style="font-size:10px;">ASTRO 3 <div class="o2-bg"><div id="o2-3" class="o2-fill"></div></div></div>
        </div>

        <div id="dpad">
            <div></div><button class="ctrl-btn" id="btn-up">▲</button><div></div>
            <button class="ctrl-btn" id="btn-left">◀</button><div></div><button class="ctrl-btn" id="btn-right">▶</button>
            <div></div><button class="ctrl-btn" id="btn-down">▼</button><div></div>
        </div>

        <div id="thrust-zone">
            <button id="thrust-btn" class="ctrl-btn thrust-btn">FIRE</button>
        </div>
    </div>

    <a-scene id="game-scene" style="display:none">
        <a-assets>
            <a-mixin id="m-capsule" geometry="primitive: cone; radiusBottom: 0.8; height: 1.5" material="color: white"></a-mixin>
            <a-mixin id="m-booster" geometry="primitive: cylinder; radius: 0.9; height: 1.0" material="color: #333"></a-mixin>
            <a-mixin id="m-fuel_tank" geometry="primitive
